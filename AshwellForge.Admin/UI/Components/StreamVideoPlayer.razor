@using AshwellForge.Admin.Models
@using BlazorVideoPlayer

<MudContainer class="rounded" Gutters="false">
    <Player id="advanced"
            CurrentTimeControl="true"
            DurationControl="true"
            FullscreenControl="true"
            PIPControl="true"
            VolumeControl="true"
            MuteControl="true"
            SettingsControl="true"
            ProgressControl="true"
            PlayControl="true"
            AirplayControl="true"
            PlayLargeControl="true"
            Quality="true"
            Speed="true"
            Sources="@sources"
            OnEndedVideo="OnEndedVideo"
            OnPlayVideo="OnPlayVideo"
            OnVideoTimeUpdate="@((e) => OnVideoTimeUpdate(e.currentTime,e.duration))" />
</MudContainer>

@code {
    [Parameter]
    public VideoSource? Source { get; set; }

    List<Source> sources = new();

    protected override void OnInitialized()
    {
        if (Source is not null)
        {
            sources.Add(Source.ToBVPSource());
        }
    }

    void OnEndedVideo()
    {
        Console.WriteLine("End of play");
    }

    void OnPlayVideo()
    {
        Console.WriteLine("Start playing");
    }

    void OnVideoTimeUpdate(float currentTime, float duration)
    {
        Console.WriteLine("Current Time: " + currentTime);
        Console.WriteLine("Duration: " + duration);
    }
}
