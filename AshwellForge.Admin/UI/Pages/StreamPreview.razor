@page "/streams/preview"
@using AshwellForge.Admin.Models
@using AshwellForge.Admin.Utils
@inject NavigationManager NavigationManager

<PageContainer Title="Stream Preview">
    <PageContent>
        <MudPaper Class="pa-2" Width="100%">
            <StreamVideoPlayer Source="GetVideoSource()" />
        </MudPaper>
    </PageContent>
</PageContainer>

@code {
    public string? StreamPath { get; set; }

    public string StreamUrl => $"{NavigationManager.BaseUri}{StreamPath}.flv";

    protected override void OnParametersSet()
    {
        var uri = NavigationManager.ToAbsoluteUri(NavigationManager.Uri);
        var parameters = UrlQueryString.From(uri.Query);

        StreamPath = parameters.Get("StreamPath");
    }

    VideoSource GetVideoSource() => VideoSource.Flv($"{NavigationManager.BaseUri}{StreamPath}.flv");
}
